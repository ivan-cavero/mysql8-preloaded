# docker-mysql8-preloaded

`docker-mysql8-preloaded` is a project that allows you to create a customized Docker image of MySQL 8 with preloaded data from `.sql` dump files. This project provides an automated way to build, tag, and publish a Docker image with a configured MySQL database.

## Features

- **Automated Build**: Creates a Docker image with MySQL 8.
- **Data Import**: Loads data from multiple `.sql` dump files into the MySQL database.
- **Publishing**: Publishes the image to Docker Hub or a local registry.
- **Port Configuration**: Allows you to configure the host port for accessing MySQL.
- **Container Information**: Provides a command to run the container in informative mode.

## Project Structure

- `Dockerfile`: Defines the Docker image for MySQL 8.
- `data/`: Folder containing the `.sql` dump files to be loaded into the database.
- `build.sh`: Script to build the Docker image, import data, and publish the image.

## How It Works

1. **Image Building**: The `build.sh` script builds a Docker image based on the provided `Dockerfile`.
2. **Container Creation and Configuration**: The script creates and starts a temporary MySQL container.
3. **Data Import**: Loads dump files from the `data/` folder into the container.
4. **Commit and Tag**: Commits the container to create a new image with the imported data and tags it with a timestamp.
5. **Publishing**: Allows the user to publish the image to Docker Hub or a local registry.
6. **Cleanup**: Removes the temporary container and old images if necessary.

## Usage

### 1. Prepare the Environment

- Ensure Docker is installed and running on your system.
- Place your `.sql` dump files in the `data/` folder.

### 2. Build and Run the Script

1. **Make the Script Executable**:

```bash
   chmod +x build.sh
```

2. **Run the Script**:

```bash
   ./build.sh
```

3. **Run the Container in Informative Mode**:

After building and publishing the image, you can run the container in informative mode using the command provided by the script at the end of its execution. The command will look like:

```bash
docker run --name mysql8-preloaded_info -e MYSQL_ROOT_PASSWORD=root -d -p 3307:3306 yourusername/mysql8-preloaded:<timestamp>
```

Note: Replace <timestamp> with the generated timestamp tag and 3307 with the host port you specified.

## Examples

1. **Building and Publishing to Docker Hub**:
Run the script and follow the prompts to build and publish the image to Docker Hub.

2. **Running the Container**:
Use the command generated by the script to start a container with the MySQL database and access it on the specified port.

3. **Publishing Options**:
   - Docker Hub: The image will be tagged and pushed to Docker Hub.
   - Local Registry: The image will be tagged and pushed to a local registry (configure the local registry in the DOCKER_REGISTRY variable in the script).

## Cleanup

The script also provides options to clean up the temporary container and image after completing the process.

To remove the temporary container and image, use the following commands:

```bash
docker rm -f temp-mysql
docker rmi mysql8-preloaded:<timestamp>
```

## Contributing

Contributions are welcome! If you find any issues or have suggestions for improvements, please create an issue or submit a pull request on the GitHub repository.

## License

This project is licensed under the MIT License.